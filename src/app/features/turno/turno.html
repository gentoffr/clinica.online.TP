<div class="turno-card">
  <header class="header">
    <div class="avatar-wrap">
      <img *ngIf="pacienteAvatar; else inicial" [src]="pacienteAvatar" class="avatar" alt="Paciente" />
      <ng-template #inicial>
        <div class="avatar avatar--placeholder">{{ pacienteNombre?.charAt(0) || '?' }}</div>
      </ng-template>
    </div>
    <div class="header-info">
      <h2>{{ pacienteNombre }}</h2>
      <p class="muted" *ngIf="pacienteEmail">{{ pacienteEmail }}</p>
    </div>
  </header>

  <form [formGroup]="form" (ngSubmit)="enviar()" class="wizard">
    <div class="slides">
      <div class="track" [style.transform]="'translateX(' + (-33.333 * slideIndex) + '%)'"><!-- 0, -33.333, -66.666 -->
        <section class="slide">
          <label>
            <span>Altura (cm)</span>
            <input type="number" formControlName="altura" placeholder="Ej: 175" min="30" max="250" />
            <small *ngIf="invalid('altura')">Ingrese una altura válida (30–250 cm)</small>
          </label>
          <label>
            <span>Peso (kg)</span>
            <input type="number" formControlName="peso" placeholder="Ej: 70" min="2" max="400" />
            <small *ngIf="invalid('peso')">Ingrese un peso válido (2–400 kg)</small>
          </label>
        </section>
        <section class="slide">
          <label>
            <span>Temperatura (°C)</span>
            <input type="number" step="0.1" formControlName="temperatura" placeholder="Ej: 36.5" min="30" max="45" />
            <small *ngIf="invalid('temperatura')">Ingrese una temperatura válida (30–45 °C)</small>
          </label>
          <label>
            <span>Presión (mmHg)</span>
            <input type="text" formControlName="presion" placeholder="Ej: 120/80" />
            <small *ngIf="invalid('presion')">Formato esperado: 90-200/50-130</small>
          </label>
        </section>
        <section class="slide">
          <label class="full">
            <span>Diagnóstico</span>
            <textarea rows="6" formControlName="diagnostico" placeholder="Ingrese el diagnóstico..."></textarea>
            <small *ngIf="invalid('diagnostico')">El diagnóstico es requerido</small>
          </label>
        </section>
      </div>
    </div>

    <footer class="actions">
      <button type="button" class="btn-secondary" (click)="cancelar.emit()" [disabled]="loading">Cancelar</button>
      <button type="button" class="btn-secondary" (click)="prev()" [disabled]="slideIndex===0">Atrás</button>
      <button *ngIf="slideIndex<2" type="button" class="btn" (click)="next()" [disabled]="loading">Siguiente</button>
      <button *ngIf="slideIndex===2" type="submit" class="btn" [disabled]="loading || form.invalid">
        <span *ngIf="loading" class="spinner"></span>
        Guardar
      </button>
    </footer>
  </form>
</div>
